using System;
using System.Collections.Generic;

namespace BitFaster.Caching
{
    // Using the capacity passed into the cache ctor to initialize the ConcurrentDictionary has 2 problems:
    //
    // 1. By allocating up front, we eliminate resizing. However, if the capacity is very large and the cache is not used,
    // we will waste a lot of memory.
    // 2. On earlier versions of .NET, ConcurrentDictionary uses the capacity arg to directly initialize the hash table
    // size. On resize, the hashtable is grown to 2x + 1 while avoiding factors of 3, 5, or 7 (but not larger). On
    // newer versions of.NET, both initial size and resize is based the next prime number larger than capacity. Collisions
    // are reduced when hash table size is prime. Hence the change to use primes in all cases in newer versions of the
    // framework.
    //
    // To mitigate this, we adopt a simple scheme: find the next prime larger than the capacity arg, up to 137. If the
    // capacity is greater than 137, just set the initial size to 137, thereby bounding initial memory consumption for
    // large caches.
    // 
    // - Older.NET implementations: For smaller caches, we fix size at the next largest prime. For larger tables, we now
    // start out with a larger prime (avoiding all factors up to 137, not just 3, 5 and 7). Above 137, some sizes will be
    // prime and others have relatively few factors.The complete list is given as a comment in the unit test code.
    // - Newer.NET implementations: as above for smaller caches. For larger caches, the resize will use successively larger
    // primes.The duplicate prime computation added is only during construction and is effectively a no-op.
    internal class HashTableSize
    {
        internal static int NextPrimeGreaterThan(int min)
        {
            foreach (int prime in Primes)
            {
                if (prime > min)
                {
                    return prime;
                }
            }

            return 197;
        }

        internal static int Estimate(int desiredSize)
        {
            // When small, exact size hashtable to nearest larger prime number
            if (desiredSize <= 197)
            {
                return NextPrimeGreaterThan(desiredSize);
            }

            // When large, size to approx 10% of desired size to save memory. Initial value is chosen such
            // that 3x ConcurrentDictionary resize operations will select a prime number slightly larger
            // than desired size.
            foreach (var pair in SizeMap)
            {
                if (pair.Key > desiredSize)
                {
                    return pair.Value;
                }
            }

            // TODO: is this reasonable for large hashtables? Check if it will resize to max array size.
            return 250478587;
        }

#if NETSTANDARD2_0
        internal static int[] Primes = new int[] {
#else
        internal static ReadOnlySpan<int> Primes => new int[] {
#endif
            7, 11, 17, 23, 29, 37, 47, 59, 71, 89, 107, 131, 163, 197
        };

#if NETSTANDARD2_0
        internal static KeyValuePair<int, int>[] SizeMap =
#else
        internal static ReadOnlySpan<KeyValuePair<int, int>> SizeMap =>
#endif
            new KeyValuePair<int, int>[576]
            {
                new KeyValuePair<int, int>(197, 197),
                new KeyValuePair<int, int>(277, 137),
                new KeyValuePair<int, int>(331, 163),
                new KeyValuePair<int, int>(337, 167),
                new KeyValuePair<int, int>(359, 179),
                new KeyValuePair<int, int>(397, 197),
                new KeyValuePair<int, int>(443, 221),
                new KeyValuePair<int, int>(499, 247),
                new KeyValuePair<int, int>(557, 137),
                new KeyValuePair<int, int>(599, 149),
                new KeyValuePair<int, int>(677, 167),
                new KeyValuePair<int, int>(719, 179),
                new KeyValuePair<int, int>(797, 197),
                new KeyValuePair<int, int>(839, 209),
                new KeyValuePair<int, int>(887, 221),
                new KeyValuePair<int, int>(919, 227),
                new KeyValuePair<int, int>(1061, 131),
                new KeyValuePair<int, int>(1117, 137),
                new KeyValuePair<int, int>(1129, 139),
                new KeyValuePair<int, int>(1171, 143),
                new KeyValuePair<int, int>(1237, 151),
                new KeyValuePair<int, int>(1283, 157),
                new KeyValuePair<int, int>(1439, 179),
                new KeyValuePair<int, int>(1481, 181),
                new KeyValuePair<int, int>(1559, 193),
                new KeyValuePair<int, int>(1597, 197),
                new KeyValuePair<int, int>(1607, 199),
                new KeyValuePair<int, int>(1777, 221),
                new KeyValuePair<int, int>(1801, 223),
                new KeyValuePair<int, int>(1847, 229),
                new KeyValuePair<int, int>(1877, 233),
                new KeyValuePair<int, int>(2011, 247),
                new KeyValuePair<int, int>(2017, 251),
                new KeyValuePair<int, int>(2179, 269),
                new KeyValuePair<int, int>(2237, 277),
                new KeyValuePair<int, int>(2347, 289),
                new KeyValuePair<int, int>(2357, 293),
                new KeyValuePair<int, int>(2399, 299),
                new KeyValuePair<int, int>(2477, 307),
                new KeyValuePair<int, int>(2683, 331),
                new KeyValuePair<int, int>(2797, 347),
                new KeyValuePair<int, int>(2851, 353),
                new KeyValuePair<int, int>(2879, 359),
                new KeyValuePair<int, int>(2963, 367),
                new KeyValuePair<int, int>(3019, 373),
                new KeyValuePair<int, int>(3119, 389),
                new KeyValuePair<int, int>(3217, 401),
                new KeyValuePair<int, int>(3359, 419),
                new KeyValuePair<int, int>(3407, 421),
                new KeyValuePair<int, int>(3457, 431),
                new KeyValuePair<int, int>(3527, 439),
                new KeyValuePair<int, int>(3557, 443),
                new KeyValuePair<int, int>(3607, 449),
                new KeyValuePair<int, int>(3691, 457),
                new KeyValuePair<int, int>(3697, 461),
                new KeyValuePair<int, int>(3719, 463),
                new KeyValuePair<int, int>(3917, 487),
                new KeyValuePair<int, int>(3943, 491),
                new KeyValuePair<int, int>(4027, 499),
                new KeyValuePair<int, int>(4079, 509),
                new KeyValuePair<int, int>(4157, 517),
                new KeyValuePair<int, int>(4363, 541),
                new KeyValuePair<int, int>(4397, 547),
                new KeyValuePair<int, int>(4597, 571),
                new KeyValuePair<int, int>(4643, 577),
                new KeyValuePair<int, int>(4799, 599),
                new KeyValuePair<int, int>(4877, 607),
                new KeyValuePair<int, int>(4919, 613),
                new KeyValuePair<int, int>(4957, 617),
                new KeyValuePair<int, int>(4967, 619),
                new KeyValuePair<int, int>(5039, 629),
                new KeyValuePair<int, int>(5087, 631),
                new KeyValuePair<int, int>(5237, 653),
                new KeyValuePair<int, int>(5399, 673),
                new KeyValuePair<int, int>(5437, 677),
                new KeyValuePair<int, int>(5483, 683),
                new KeyValuePair<int, int>(5557, 691),
                new KeyValuePair<int, int>(5623, 701),
                new KeyValuePair<int, int>(5879, 733),
                new KeyValuePair<int, int>(5927, 739),
                new KeyValuePair<int, int>(6043, 751),
                new KeyValuePair<int, int>(6101, 761),
                new KeyValuePair<int, int>(6211, 773),
                new KeyValuePair<int, int>(6323, 787),
                new KeyValuePair<int, int>(6397, 797),
                new KeyValuePair<int, int>(6521, 811),
                new KeyValuePair<int, int>(6577, 821),
                new KeyValuePair<int, int>(6599, 823),
                new KeyValuePair<int, int>(6637, 827),
                new KeyValuePair<int, int>(6719, 839),
                new KeyValuePair<int, int>(6841, 853),
                new KeyValuePair<int, int>(6883, 857),
                new KeyValuePair<int, int>(6917, 863),
                new KeyValuePair<int, int>(6967, 869),
                new KeyValuePair<int, int>(7057, 881),
                new KeyValuePair<int, int>(7079, 883),
                new KeyValuePair<int, int>(7219, 899),
                new KeyValuePair<int, int>(7517, 937),
                new KeyValuePair<int, int>(7559, 941),
                new KeyValuePair<int, int>(7607, 947),
                new KeyValuePair<int, int>(7639, 953),
                new KeyValuePair<int, int>(7723, 961),
                new KeyValuePair<int, int>(7757, 967),
                new KeyValuePair<int, int>(8059, 1003),
                new KeyValuePair<int, int>(8317, 1037),
                new KeyValuePair<int, int>(8731, 1087),
                new KeyValuePair<int, int>(9067, 1129),
                new KeyValuePair<int, int>(9403, 1171),
                new KeyValuePair<int, int>(9437, 1177),
                new KeyValuePair<int, int>(9839, 1229),
                new KeyValuePair<int, int>(10079, 1259),
                new KeyValuePair<int, int>(10177, 1271),
                new KeyValuePair<int, int>(10477, 1307),
                new KeyValuePair<int, int>(10799, 1349),
                new KeyValuePair<int, int>(11117, 1387),
                new KeyValuePair<int, int>(11197, 1397),
                new KeyValuePair<int, int>(11251, 1403),
                new KeyValuePair<int, int>(11519, 1439),
                new KeyValuePair<int, int>(11677, 1457),
                new KeyValuePair<int, int>(11923, 1487),
                new KeyValuePair<int, int>(12157, 1517),
                new KeyValuePair<int, int>(12203, 1523),
                new KeyValuePair<int, int>(12343, 1541),
                new KeyValuePair<int, int>(12479, 1559),
                new KeyValuePair<int, int>(12647, 1577),
                new KeyValuePair<int, int>(12959, 1619),
                new KeyValuePair<int, int>(13043, 1627),
                new KeyValuePair<int, int>(13297, 1661),
                new KeyValuePair<int, int>(13687, 1709),
                new KeyValuePair<int, int>(14107, 1759),
                new KeyValuePair<int, int>(14159, 1769),
                new KeyValuePair<int, int>(14557, 1817),
                new KeyValuePair<int, int>(14779, 1843),
                new KeyValuePair<int, int>(14797, 1847),
                new KeyValuePair<int, int>(14879, 1859),
                new KeyValuePair<int, int>(15217, 1901),
                new KeyValuePair<int, int>(15451, 1927),
                new KeyValuePair<int, int>(15787, 1969),
                new KeyValuePair<int, int>(16007, 1997),
                new KeyValuePair<int, int>(16319, 2039),
                new KeyValuePair<int, int>(17467, 2179),
                new KeyValuePair<int, int>(17597, 2197),
                new KeyValuePair<int, int>(18397, 2297),
                new KeyValuePair<int, int>(19037, 2377),
                new KeyValuePair<int, int>(20357, 2543),
                new KeyValuePair<int, int>(21163, 2641),
                new KeyValuePair<int, int>(21277, 2657),
                new KeyValuePair<int, int>(21499, 2683),
                new KeyValuePair<int, int>(21599, 2699),
                new KeyValuePair<int, int>(21757, 2717),
                new KeyValuePair<int, int>(21937, 2741),
                new KeyValuePair<int, int>(22397, 2797),
                new KeyValuePair<int, int>(23039, 2879),
                new KeyValuePair<int, int>(23357, 2917),
                new KeyValuePair<int, int>(24317, 3037),
                new KeyValuePair<int, int>(24407, 3047),
                new KeyValuePair<int, int>(24691, 3083),
                new KeyValuePair<int, int>(24859, 3103),
                new KeyValuePair<int, int>(25919, 3239),
                new KeyValuePair<int, int>(26317, 3287),
                new KeyValuePair<int, int>(26399, 3299),
                new KeyValuePair<int, int>(26557, 3317),
                new KeyValuePair<int, int>(26597, 3323),
                new KeyValuePair<int, int>(26879, 3359),
                new KeyValuePair<int, int>(27277, 3407),
                new KeyValuePair<int, int>(27883, 3481),
                new KeyValuePair<int, int>(28219, 3523),
                new KeyValuePair<int, int>(28319, 3539),
                new KeyValuePair<int, int>(28477, 3557),
                new KeyValuePair<int, int>(29759, 3719),
                new KeyValuePair<int, int>(31357, 3917),
                new KeyValuePair<int, int>(32251, 4027),
                new KeyValuePair<int, int>(33599, 4199),
                new KeyValuePair<int, int>(33997, 4247),
                new KeyValuePair<int, int>(34939, 4363),
                new KeyValuePair<int, int>(35837, 4477),
                new KeyValuePair<int, int>(36479, 4559),
                new KeyValuePair<int, int>(38737, 4841),
                new KeyValuePair<int, int>(39359, 4919),
                new KeyValuePair<int, int>(41117, 5137),
                new KeyValuePair<int, int>(41659, 5203),
                new KeyValuePair<int, int>(42331, 5287),
                new KeyValuePair<int, int>(42557, 5317),
                new KeyValuePair<int, int>(43003, 5371),
                new KeyValuePair<int, int>(43517, 5437),
                new KeyValuePair<int, int>(44797, 5597),
                new KeyValuePair<int, int>(45691, 5707),
                new KeyValuePair<int, int>(48817, 6101),
                new KeyValuePair<int, int>(49277, 6157),
                new KeyValuePair<int, int>(49919, 6239),
                new KeyValuePair<int, int>(51197, 6397),
                new KeyValuePair<int, int>(51517, 6437),
                new KeyValuePair<int, int>(51839, 6479),
                new KeyValuePair<int, int>(52177, 6521),
                new KeyValuePair<int, int>(53117, 6637),
                new KeyValuePair<int, int>(53197, 6647),
                new KeyValuePair<int, int>(53759, 6719),
                new KeyValuePair<int, int>(55117, 6887),
                new KeyValuePair<int, int>(56443, 7051),
                new KeyValuePair<int, int>(56477, 7057),
                new KeyValuePair<int, int>(56957, 7117),
                new KeyValuePair<int, int>(57787, 7219),
                new KeyValuePair<int, int>(58237, 7277),
                new KeyValuePair<int, int>(59197, 7397),
                new KeyValuePair<int, int>(61819, 7723),
                new KeyValuePair<int, int>(64037, 8003),
                new KeyValuePair<int, int>(72959, 9119),
                new KeyValuePair<int, int>(73597, 9197),
                new KeyValuePair<int, int>(74317, 9287),
                new KeyValuePair<int, int>(76157, 9517),
                new KeyValuePair<int, int>(77477, 9683),
                new KeyValuePair<int, int>(79357, 9917),
                new KeyValuePair<int, int>(82237, 10277),
                new KeyValuePair<int, int>(82651, 10327),
                new KeyValuePair<int, int>(86011, 10747),
                new KeyValuePair<int, int>(86399, 10799),
                new KeyValuePair<int, int>(87037, 10877),
                new KeyValuePair<int, int>(89597, 11197),
                new KeyValuePair<int, int>(91387, 11419),
                new KeyValuePair<int, int>(94079, 11759),
                new KeyValuePair<int, int>(95419, 11923),
                new KeyValuePair<int, int>(96763, 12091),
                new KeyValuePair<int, int>(98779, 12343),
                new KeyValuePair<int, int>(99839, 12479),
                new KeyValuePair<int, int>(101197, 12647),
                new KeyValuePair<int, int>(102397, 12797),
                new KeyValuePair<int, int>(105277, 13157),
                new KeyValuePair<int, int>(106397, 13297),
                new KeyValuePair<int, int>(110237, 13777),
                new KeyValuePair<int, int>(113279, 14159),
                new KeyValuePair<int, int>(116923, 14611),
                new KeyValuePair<int, int>(119039, 14879),
                new KeyValuePair<int, int>(122299, 15283),
                new KeyValuePair<int, int>(129277, 16157),
                new KeyValuePair<int, int>(133117, 16637),
                new KeyValuePair<int, int>(134399, 16799),
                new KeyValuePair<int, int>(140797, 17597),
                new KeyValuePair<int, int>(143357, 17917),
                new KeyValuePair<int, int>(147197, 18397),
                new KeyValuePair<int, int>(150523, 18811),
                new KeyValuePair<int, int>(156157, 19517),
                new KeyValuePair<int, int>(164477, 20557),
                new KeyValuePair<int, int>(167677, 20957),
                new KeyValuePair<int, int>(169339, 21163),
                new KeyValuePair<int, int>(172027, 21499),
                new KeyValuePair<int, int>(174077, 21757),
                new KeyValuePair<int, int>(177917, 22237),
                new KeyValuePair<int, int>(182779, 22843),
                new KeyValuePair<int, int>(186877, 23357),
                new KeyValuePair<int, int>(188159, 23519),
                new KeyValuePair<int, int>(189757, 23717),
                new KeyValuePair<int, int>(190843, 23851),
                new KeyValuePair<int, int>(195277, 24407),
                new KeyValuePair<int, int>(197117, 24637),
                new KeyValuePair<int, int>(199679, 24959),
                new KeyValuePair<int, int>(204797, 25597),
                new KeyValuePair<int, int>(206077, 25757),
                new KeyValuePair<int, int>(210557, 26317),
                new KeyValuePair<int, int>(211199, 26399),
                new KeyValuePair<int, int>(220411, 27547),
                new KeyValuePair<int, int>(223099, 27883),
                new KeyValuePair<int, int>(233851, 29227),
                new KeyValuePair<int, int>(238079, 29759),
                new KeyValuePair<int, int>(241919, 30239),
                new KeyValuePair<int, int>(243517, 30437),
                new KeyValuePair<int, int>(244603, 30571),
                new KeyValuePair<int, int>(248317, 31037),
                new KeyValuePair<int, int>(249037, 31127),
                new KeyValuePair<int, int>(252667, 31579),
                new KeyValuePair<int, int>(294397, 36797),
                new KeyValuePair<int, int>(301051, 37627),
                new KeyValuePair<int, int>(314879, 39359),
                new KeyValuePair<int, int>(317437, 39677),
                new KeyValuePair<int, int>(318077, 39757),
                new KeyValuePair<int, int>(322559, 40319),
                new KeyValuePair<int, int>(338683, 42331),
                new KeyValuePair<int, int>(340477, 42557),
                new KeyValuePair<int, int>(345599, 43199),
                new KeyValuePair<int, int>(351037, 43877),
                new KeyValuePair<int, int>(360187, 45019),
                new KeyValuePair<int, int>(373757, 46717),
                new KeyValuePair<int, int>(389117, 48637),
                new KeyValuePair<int, int>(409597, 51197),
                new KeyValuePair<int, int>(412157, 51517),
                new KeyValuePair<int, int>(417437, 52177),
                new KeyValuePair<int, int>(436477, 54557),
                new KeyValuePair<int, int>(451579, 56443),
                new KeyValuePair<int, int>(451837, 56477),
                new KeyValuePair<int, int>(453119, 56639),
                new KeyValuePair<int, int>(462331, 57787),
                new KeyValuePair<int, int>(465917, 58237),
                new KeyValuePair<int, int>(473597, 59197),
                new KeyValuePair<int, int>(483839, 60479),
                new KeyValuePair<int, int>(494587, 61819),
                new KeyValuePair<int, int>(505339, 63163),
                new KeyValuePair<int, int>(516091, 64507),
                new KeyValuePair<int, int>(522239, 65279),
                new KeyValuePair<int, int>(537599, 67199),
                new KeyValuePair<int, int>(543997, 67997),
                new KeyValuePair<int, int>(559099, 69883),
                new KeyValuePair<int, int>(563197, 70397),
                new KeyValuePair<int, int>(573437, 71677),
                new KeyValuePair<int, int>(609277, 76157),
                new KeyValuePair<int, int>(651517, 81437),
                new KeyValuePair<int, int>(677371, 84667),
                new KeyValuePair<int, int>(691199, 86399),
                new KeyValuePair<int, int>(696317, 87037),
                new KeyValuePair<int, int>(702077, 87757),
                new KeyValuePair<int, int>(737279, 92159),
                new KeyValuePair<int, int>(752639, 94079),
                new KeyValuePair<int, int>(759037, 94877),
                new KeyValuePair<int, int>(778237, 97277),
                new KeyValuePair<int, int>(781117, 97637),
                new KeyValuePair<int, int>(795643, 99451),
                new KeyValuePair<int, int>(849917, 106237),
                new KeyValuePair<int, int>(851197, 106397),
                new KeyValuePair<int, int>(881917, 110237),
                new KeyValuePair<int, int>(903163, 112891),
                new KeyValuePair<int, int>(903677, 112957),
                new KeyValuePair<int, int>(911357, 113917),
                new KeyValuePair<int, int>(931837, 116477),
                new KeyValuePair<int, int>(947197, 118397),
                new KeyValuePair<int, int>(978427, 122299),
                new KeyValuePair<int, int>(996157, 124517),
                new KeyValuePair<int, int>(1003517, 125437),
                new KeyValuePair<int, int>(1010683, 126331),
                new KeyValuePair<int, int>(1034237, 129277),
                new KeyValuePair<int, int>(1044479, 130559),
                new KeyValuePair<int, int>(1064957, 133117),
                new KeyValuePair<int, int>(1118203, 139771),
                new KeyValuePair<int, int>(1126397, 140797),
                new KeyValuePair<int, int>(1146877, 143357),
                new KeyValuePair<int, int>(1167359, 145919),
                new KeyValuePair<int, int>(1204219, 150523),
                new KeyValuePair<int, int>(1218557, 152317),
                new KeyValuePair<int, int>(1269757, 158717),
                new KeyValuePair<int, int>(1303037, 162877),
                new KeyValuePair<int, int>(1315837, 164477),
                new KeyValuePair<int, int>(1341437, 167677),
                new KeyValuePair<int, int>(1440763, 180091),
                new KeyValuePair<int, int>(1474559, 184319),
                new KeyValuePair<int, int>(1505279, 188159),
                new KeyValuePair<int, int>(1576957, 197117),
                new KeyValuePair<int, int>(1684477, 210557),
                new KeyValuePair<int, int>(1699837, 212477),
                new KeyValuePair<int, int>(1763323, 220411),
                new KeyValuePair<int, int>(1806331, 225787),
                new KeyValuePair<int, int>(1807357, 225917),
                new KeyValuePair<int, int>(1863677, 232957),
                new KeyValuePair<int, int>(1894397, 236797),
                new KeyValuePair<int, int>(1925117, 240637),
                new KeyValuePair<int, int>(1956859, 244603),
                new KeyValuePair<int, int>(1978363, 247291),
                new KeyValuePair<int, int>(2037757, 254717),
                new KeyValuePair<int, int>(2064379, 258043),
                new KeyValuePair<int, int>(2068477, 258557),
                new KeyValuePair<int, int>(2150399, 268799),
                new KeyValuePair<int, int>(2175997, 271997),
                new KeyValuePair<int, int>(2293757, 286717),
                new KeyValuePair<int, int>(2378237, 297277),
                new KeyValuePair<int, int>(2544637, 318077),
                new KeyValuePair<int, int>(2666491, 333307),
                new KeyValuePair<int, int>(2723837, 340477),
                new KeyValuePair<int, int>(2846717, 355837),
                new KeyValuePair<int, int>(2881531, 360187),
                new KeyValuePair<int, int>(2949119, 368639),
                new KeyValuePair<int, int>(3053563, 381691),
                new KeyValuePair<int, int>(3096571, 387067),
                new KeyValuePair<int, int>(3194879, 399359),
                new KeyValuePair<int, int>(3238397, 404797),
                new KeyValuePair<int, int>(3368957, 421117),
                new KeyValuePair<int, int>(3543037, 442877),
                new KeyValuePair<int, int>(3612667, 451579),
                new KeyValuePair<int, int>(3698683, 462331),
                new KeyValuePair<int, int>(3809279, 476159),
                new KeyValuePair<int, int>(3850237, 481277),
                new KeyValuePair<int, int>(3870719, 483839),
                new KeyValuePair<int, int>(3896317, 487037),
                new KeyValuePair<int, int>(3973117, 496637),
                new KeyValuePair<int, int>(4098557, 512317),
                new KeyValuePair<int, int>(4128763, 516091),
                new KeyValuePair<int, int>(4259837, 532477),
                new KeyValuePair<int, int>(4472827, 559099),
                new KeyValuePair<int, int>(4505597, 563197),
                new KeyValuePair<int, int>(4710397, 588797),
                new KeyValuePair<int, int>(5038079, 629759),
                new KeyValuePair<int, int>(5079037, 634877),
                new KeyValuePair<int, int>(5089277, 636157),
                new KeyValuePair<int, int>(5160959, 645119),
                new KeyValuePair<int, int>(5212157, 651517),
                new KeyValuePair<int, int>(5289979, 661243),
                new KeyValuePair<int, int>(5763067, 720379),
                new KeyValuePair<int, int>(6072317, 759037),
                new KeyValuePair<int, int>(6225917, 778237),
                new KeyValuePair<int, int>(6594557, 824317),
                new KeyValuePair<int, int>(6809597, 851197),
                new KeyValuePair<int, int>(6983677, 872957),
                new KeyValuePair<int, int>(7053307, 881659),
                new KeyValuePair<int, int>(7139323, 892411),
                new KeyValuePair<int, int>(7249919, 906239),
                new KeyValuePair<int, int>(7913467, 989179),
                new KeyValuePair<int, int>(8257531, 1032187),
                new KeyValuePair<int, int>(9175037, 1146877),
                new KeyValuePair<int, int>(9633787, 1204219),
                new KeyValuePair<int, int>(10076159, 1259519),
                new KeyValuePair<int, int>(10158077, 1269757),
                new KeyValuePair<int, int>(10178557, 1272317),
                new KeyValuePair<int, int>(10321919, 1290239),
                new KeyValuePair<int, int>(10424317, 1303037),
                new KeyValuePair<int, int>(10526717, 1315837),
                new KeyValuePair<int, int>(10665979, 1333243),
                new KeyValuePair<int, int>(11386877, 1423357),
                new KeyValuePair<int, int>(11468797, 1433597),
                new KeyValuePair<int, int>(11698171, 1462267),
                new KeyValuePair<int, int>(12144637, 1518077),
                new KeyValuePair<int, int>(12386299, 1548283),
                new KeyValuePair<int, int>(12730363, 1591291),
                new KeyValuePair<int, int>(13107197, 1638397),
                new KeyValuePair<int, int>(13271039, 1658879),
                new KeyValuePair<int, int>(13358077, 1669757),
                new KeyValuePair<int, int>(14020603, 1752571),
                new KeyValuePair<int, int>(14106619, 1763323),
                new KeyValuePair<int, int>(14110717, 1763837),
                new KeyValuePair<int, int>(14499839, 1812479),
                new KeyValuePair<int, int>(14581757, 1822717),
                new KeyValuePair<int, int>(14966779, 1870843),
                new KeyValuePair<int, int>(16056317, 2007037),
                new KeyValuePair<int, int>(16394237, 2049277),
                new KeyValuePair<int, int>(16515067, 2064379),
                new KeyValuePair<int, int>(16547837, 2068477),
                new KeyValuePair<int, int>(19496957, 2437117),
                new KeyValuePair<int, int>(19660799, 2457599),
                new KeyValuePair<int, int>(19834877, 2479357),
                new KeyValuePair<int, int>(19988477, 2498557),
                new KeyValuePair<int, int>(20848637, 2606077),
                new KeyValuePair<int, int>(21053437, 2631677),
                new KeyValuePair<int, int>(21331963, 2666491),
                new KeyValuePair<int, int>(22020091, 2752507),
                new KeyValuePair<int, int>(22118399, 2764799),
                new KeyValuePair<int, int>(22466557, 2808317),
                new KeyValuePair<int, int>(24084479, 3010559),
                new KeyValuePair<int, int>(24428539, 3053563),
                new KeyValuePair<int, int>(24772603, 3096571),
                new KeyValuePair<int, int>(25460731, 3182587),
                new KeyValuePair<int, int>(25907197, 3238397),
                new KeyValuePair<int, int>(27934717, 3491837),
                new KeyValuePair<int, int>(28344317, 3543037),
                new KeyValuePair<int, int>(29589499, 3698683),
                new KeyValuePair<int, int>(30277627, 3784699),
                new KeyValuePair<int, int>(30474239, 3809279),
                new KeyValuePair<int, int>(30801917, 3850237),
                new KeyValuePair<int, int>(31309819, 3913723),
                new KeyValuePair<int, int>(32788477, 4098557),
                new KeyValuePair<int, int>(33095677, 4136957),
                new KeyValuePair<int, int>(34406399, 4300799),
                new KeyValuePair<int, int>(36044797, 4505597),
                new KeyValuePair<int, int>(38051837, 4756477),
                new KeyValuePair<int, int>(38993917, 4874237),
                new KeyValuePair<int, int>(39321599, 4915199),
                new KeyValuePair<int, int>(39669757, 4958717),
                new KeyValuePair<int, int>(40714237, 5089277),
                new KeyValuePair<int, int>(43581437, 5447677),
                new KeyValuePair<int, int>(44040187, 5505019),
                new KeyValuePair<int, int>(44236799, 5529599),
                new KeyValuePair<int, int>(45547517, 5693437),
                new KeyValuePair<int, int>(46104571, 5763067),
                new KeyValuePair<int, int>(46792699, 5849083),
                new KeyValuePair<int, int>(48578557, 6072317),
                new KeyValuePair<int, int>(51814397, 6476797),
                new KeyValuePair<int, int>(53432317, 6679037),
                new KeyValuePair<int, int>(54394877, 6799357),
                new KeyValuePair<int, int>(54476797, 6809597),
                new KeyValuePair<int, int>(56688637, 7086077),
                new KeyValuePair<int, int>(58327037, 7290877),
                new KeyValuePair<int, int>(60948479, 7618559),
                new KeyValuePair<int, int>(62341117, 7792637),
                new KeyValuePair<int, int>(62619643, 7827451),
                new KeyValuePair<int, int>(63569917, 7946237),
                new KeyValuePair<int, int>(69631997, 8703997),
                new KeyValuePair<int, int>(75366397, 9420797),
                new KeyValuePair<int, int>(78643199, 9830399),
                new KeyValuePair<int, int>(80609279, 10076159),
                new KeyValuePair<int, int>(96337919, 12042239),
                new KeyValuePair<int, int>(99090427, 12386299),
                new KeyValuePair<int, int>(99983357, 12497917),
                new KeyValuePair<int, int>(106168319, 13271039),
                new KeyValuePair<int, int>(115671037, 14458877),
                new KeyValuePair<int, int>(115998719, 14499839),
                new KeyValuePair<int, int>(116654077, 14581757),
                new KeyValuePair<int, int>(119734267, 14966779),
                new KeyValuePair<int, int>(121110523, 15138811),
                new KeyValuePair<int, int>(121241597, 15155197),
                new KeyValuePair<int, int>(123207677, 15400957),
                new KeyValuePair<int, int>(125239291, 15654907),
                new KeyValuePair<int, int>(126615547, 15826939),
                new KeyValuePair<int, int>(132382717, 16547837),
                new KeyValuePair<int, int>(137625599, 17203199),
                new KeyValuePair<int, int>(144179197, 18022397),
                new KeyValuePair<int, int>(146800637, 18350077),
                new KeyValuePair<int, int>(149422079, 18677759),
                new KeyValuePair<int, int>(152207357, 19025917),
                new KeyValuePair<int, int>(165150719, 20643839),
                new KeyValuePair<int, int>(169279483, 21159931),
                new KeyValuePair<int, int>(178257917, 22282237),
                new KeyValuePair<int, int>(179732477, 22466557),
                new KeyValuePair<int, int>(188743679, 23592959),
                new KeyValuePair<int, int>(191365117, 23920637),
                new KeyValuePair<int, int>(192675839, 24084479),
                new KeyValuePair<int, int>(198180859, 24772603),
                new KeyValuePair<int, int>(209715197, 26214397),
                new KeyValuePair<int, int>(211025917, 26378237),
                new KeyValuePair<int, int>(213729277, 26716157),
                new KeyValuePair<int, int>(216268799, 27033599),
                new KeyValuePair<int, int>(224329723, 28041211),
                new KeyValuePair<int, int>(225771517, 28221437),
                new KeyValuePair<int, int>(226754557, 28344317),
                new KeyValuePair<int, int>(231997439, 28999679),
                new KeyValuePair<int, int>(238551037, 29818877),
                new KeyValuePair<int, int>(242221051, 30277627),
                new KeyValuePair<int, int>(254279677, 31784957),
                new KeyValuePair<int, int>(264241147, 33030139),
                new KeyValuePair<int, int>(297271291, 37158907),
                new KeyValuePair<int, int>(301465597, 37683197),
                new KeyValuePair<int, int>(314572799, 39321599),
                new KeyValuePair<int, int>(317358077, 39669757),
                new KeyValuePair<int, int>(325058557, 40632317),
                new KeyValuePair<int, int>(336855037, 42106877),
                new KeyValuePair<int, int>(338558971, 42319867),
                new KeyValuePair<int, int>(341311483, 42663931),
                new KeyValuePair<int, int>(348651517, 43581437),
                new KeyValuePair<int, int>(352321531, 44040187),
                new KeyValuePair<int, int>(359464957, 44933117),
                new KeyValuePair<int, int>(368836603, 46104571),
                new KeyValuePair<int, int>(385351679, 48168959),
                new KeyValuePair<int, int>(390856699, 48857083),
                new KeyValuePair<int, int>(453509117, 56688637),
                new KeyValuePair<int, int>(462422011, 57802747),
                new KeyValuePair<int, int>(463994879, 57999359),
                new KeyValuePair<int, int>(466616317, 58327037),
                new KeyValuePair<int, int>(478937083, 59867131),
                new KeyValuePair<int, int>(517472251, 64684027),
                new KeyValuePair<int, int>(521666557, 65208317),
                new KeyValuePair<int, int>(644874239, 80609279),
                new KeyValuePair<int, int>(673710077, 84213757),
                new KeyValuePair<int, int>(697303037, 87162877),
                new KeyValuePair<int, int>(704643067, 88080379),
                new KeyValuePair<int, int>(770703359, 96337919),
                new KeyValuePair<int, int>(777256957, 97157117),
                new KeyValuePair<int, int>(781713403, 97714171),
                new KeyValuePair<int, int>(796917757, 99614717),
                new KeyValuePair<int, int>(807403517, 100925437),
                new KeyValuePair<int, int>(809238523, 101154811),
                new KeyValuePair<int, int>(849346559, 106168319),
                new KeyValuePair<int, int>(865075199, 108134399),
                new KeyValuePair<int, int>(903086077, 112885757),
                new KeyValuePair<int, int>(907018237, 113377277),
                new KeyValuePair<int, int>(924844027, 115605499),
                new KeyValuePair<int, int>(927989759, 115998719),
                new KeyValuePair<int, int>(933232637, 116654077),
                new KeyValuePair<int, int>(954204157, 119275517),
                new KeyValuePair<int, int>(969932797, 121241597),
                new KeyValuePair<int, int>(997457917, 124682237),
                new KeyValuePair<int, int>(1145044987, 143130619),
                new KeyValuePair<int, int>(1233125371, 154140667),
                new KeyValuePair<int, int>(1321205759, 165150719),
                new KeyValuePair<int, int>(1394606077, 174325757),
                new KeyValuePair<int, int>(1409286139, 176160763),
                new KeyValuePair<int, int>(1457520637, 182190077),
                new KeyValuePair<int, int>(1497366523, 187170811),
                new KeyValuePair<int, int>(1541406719, 192675839),
                new KeyValuePair<int, int>(1635778559, 204472319),
                new KeyValuePair<int, int>(1658060797, 207257597),
                new KeyValuePair<int, int>(1677721597, 209715197),
                new KeyValuePair<int, int>(1855979519, 231997439),
                new KeyValuePair<int, int>(1915748347, 239468539),
                new KeyValuePair<int, int>(2003828731, 250478587),
            };
}
}
